{% extends "core/base.html" %}
{% block title %}Dashboard - Your Listings{% endblock %}

{% block styles %}
    <style>
        .dashboard-img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 5px;
        }

        .list-group-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        }

        .action-icons a {
            margin: 0 8px;
            font-size: 20px;
            color: #333;
            transition: color 0.2s ease;
        }

        .action-icons a:hover {
            color: #007bff;
        }

        .btn-add-listing {
            font-size: 24px;
            color: #28a745;
            transition: color 0.2s ease;
        }

        .btn-add-listing:hover {
            color: #218838;
        }
    </style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4 bangers-font">Dashboard</h2>

    <!-- Create Listing Button -->
    <div class="text-end mb-3">
        <a href="{% url 'listings:prelist' %}" class="btn">
            <i class="far fa-plus-square fa-2x btn-add-listing"></i> 
        </a>
    </div>

    <!-- Listings Display -->
    <div class="list-group">
        {% for listing in listings %}
        <div class="list-group-item">
            
            <!-- Left: Image -->
            <div class="me-3">
                {% with first_image=listing.images.first %}
                    {% if first_image %}
                        <img src="{{ first_image.image.url }}" alt="{{ listing.title }}" class="dashboard-img">
                    {% else %}
                        <img src="https://placehold.co/80" alt="No Image Available" class="dashboard-img">
                    {% endif %}
                {% endwith %}
            </div>

            <!-- Middle: Book Details -->
            <div class="flex-grow-1">
                <strong>{{ listing.title }}</strong> <br>
                <small class="text-muted">ISBN: {{ listing.isbn }}</small>
            </div>

            <!-- Right: Actions & Price -->
            <div class="text-end">
                {% if listing.sold %}
                    <h5><span class="badge bg-success">Sold</span></h5>
                {% else %}
                    <div class="action-icons">
                        <a href="{% url 'listings:edit_listing' listing.id %}">
                            <i class="far fa-pen-to-square"></i>  <!-- Edit Icon -->
                        </a>
                        <a href="{% url 'listings:delete_listing' listing.id %}">
                            <i class="far fa-trash-alt"></i>  <!-- Delete Icon -->
                        </a>
                    </div>
                {% endif %}
                <p class="fw-bold mt-2">${{ listing.price }}</p>  <!-- Price Below Icons -->
            </div>
            
        </div>
        {% empty %}
        <p class="text-center">No listings available.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
